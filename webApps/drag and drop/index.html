<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Drag and drop</title>
    <style>
      .container{
        background-color: darkcyan;
        display: flex;
        padding: 6px;
      }
      .element {
        width: 100px;
        height: 80px;
        background-color: cyan;
        border-style: solid;
        border-width: 0px;
        border-right-width: 3px;
        border-color: cyan;
        margin-right: 6px;
      }
    </style>
  </head>
  <body>
    <div class="container" onmousemove="" onmouseout="clearHighlight()" id="container" on>

    </div>
spawnCount:<span id="o1"></span><br />
eleCount: <span id="o2"></span><br />
eleArr: <span id="o3"></span><br />
from: <span id="o4"></span><br />
to: <span id="o5"></span><br />
element to move: <span id="o6"></span><br />
eleNum: <span id="o7"></span><br />
eleName: <span id="o8"></span><br />
<span id="o9"></span><br />
<span id="o10"></span><br />
<span id="o11"></span><br />
<span id="o12"></span><br />
<span id="o13"></span><br />
<span id="o14"></span><br />
<span id="o15"></span><br />
elements: <br /><span id="o16"></span><br />
<span id="o17"></span><br />
<span id="o18"></span><br />
<span id="o19"></span><br />
<span id="o20"></span><br />
<script>
  var eleCount = 0;
  //The elements array stores the elements inside the container, and the updateElements function puts them according to the array.
  var eleArr = [];
  function spawnElements() {
    var spawnCount = 7;
    document.getElementById('o1').innerHTML = spawnCount;
    for(i=spawnCount; i>0; i--){
      num = (i - spawnCount) * -1;
      eleArr.push(num);
      eleCount++;
      console.log('eleCount= '+eleCount);
      document.getElementById('o2').innerHTML = eleCount;
    }
    updateElements();
    console.log('the array = ' + eleArr)
    document.getElementById('o3').innerHTML = eleArr;
  }
  //spawn elements as soon as page loads
  spawnElements();
  function updateElements(){
    document.getElementById('container').innerHTML = '';
    for(i=eleArr.length; i>0; i--){
      console.log('updateEle.i = '+i);
      num = (i - eleArr.length) * -1;
      console.log('updateEle.num = '+num);
      document.getElementById('container').innerHTML += '<div class="element" ondragover="highlight()" ondragend="getDropPos()" ondragstart="getMoveFromPos()" draggable="true" id="e'+eleArr[num]+'">'+eleArr[num]+'</div>';
    }
    eleCount = eleArr.length;
    document.getElementById('o2').innerHTML = eleCount;
  }
  function spliceElementsArray() {
    var from = moveFromPos;
    var to = dropPos;
    document.getElementById('o4').innerHTML = from;
    document.getElementById('o5').innerHTML = to;
    //copy the elemnt to move
    var ele = eleArr[from];
    document.getElementById('o6').innerHTML = ele;
    //delete the old element
    eleArr.splice(from, 1);
    //put the copied elements in the new position
    eleArr.splice(to, 0, ele);
    console.log(eleArr);
    document.getElementById('o3').innerHTML = eleArr;
    //update the page
    updateElements();
  }
  var dropPos = 0;
  function getDropPos() {
    console.log('getDropPos  = '+dropPos);
    document.getElementById('o5').innerHTML = dropPos;
    spliceElementsArray()
  }
  var moveFromPos = 0;
  function getMoveFromPos() {
    eleNum = getElementNum();
    //if the mouse is not over empty space
    if(eleCount>eleNum) {
      moveFromPos = eleNum;
      console.log('move from pos = '+ moveFromPos);
      document.getElementById('o4').innerHTML = from;
    }
  }
  function clearHighlight() {
    var elements = document.getElementsByClassName('element');
    document.getElementById('o16').innerHTML = elements;
    //console.log('elements');
    for(i=elements.length-1; i>=0; i--){
      //console.log(i);
      //console.log(elements[i]);
      elements[i].style.borderColor = "cyan";
    }
  }
  function highlight(){
    eleNum = getElementNum();
    document.getElementById('o7').innerHTML = eleNum;
    //get the name of the element from the eleArr
    var eleName = 'e'+eleArr[eleNum];
    document.getElementById('o8').innerHTML = eleName;
    clearHighlight();
    //if the mouse is not over empty space change the border color.
    if(eleCount>eleNum) {
      document.getElementById(eleName).style.borderColor = 'red';
    }
  }
  function getElementNum() {
    //get the offset of the container relative to the browser screen top left corner
    var boxX = document.getElementById('container').offsetLeft;
    var boxY = document.getElementById('container').offsetTop;
    document.getElementById('o9').innerHTML = 'left box offset = '+boxX;
    document.getElementById('o10').innerHTML = 'left top offset = '+boxY;
    // get the position of the mouse insede the browser window
    var mX = event.clientX;
    var mY = event.clientY;
    document.getElementById('o11').innerHTML = 'Mouse x position = '+mX;
    document.getElementById('o12').innerHTML = 'Mouse y position = '+mY;
    //get the mouse position inside the container
    var actualX = mX - boxX;
    var actualY = mY - boxY;
    document.getElementById('o13').innerHTML = 'Actual x position = '+actualX;
    document.getElementById('o14').innerHTML = 'Actual y position = '+actualY;
    //+6 because of right margin, get the actual width of the elements insede the container
    var eleWidth = document.getElementById('e0').offsetWidth + 6;
    document.getElementById('o15').innerHTML = 'eleWidth = '+eleWidth;
    //calculata on top of which element the mouse is
    var eleNum = Math.floor(actualX / eleWidth);
    console.log(eleNum);
    dropPos = eleNum;
    document.getElementById('o7').innerHTML = eleNum;
    return(eleNum);
  }
</script>
  </body>
</html>
